\section{Discussion}

\red{Why estimation}
Epilepsy is a poorly understood disorder, and there is much uncertainty about the mechanisms involved in seizure generation. However, with computational models of neural activity getting more descriptive of physiology, it is becoming possible to gain insights into the underlying mechanism involved in observed electroenchepholographic (EEG) recordings. However, models of EEG are highly non-linear, and standard estimation techniques cannot be used to approximate the physiolgical states from these models. In this paper, the application of the unscented Kalman filter to the Wendling model has been considered. From the results shown it is clear that this method is capable of estimating the slow states from this model.

\red{Effect of stochastic input}
In  figure~\ref{fig: ESTOSFP} the estimation of excitatory synaptic gain is considered. from this image it is clear that this estimation does not converge to the true value of the parameter. However, consider the structure of the model (figure~\ref{fig: Biological} where this synaptic gain acts on numerous signals to create the observations ($v_{p}$)). One of the inputs is the firing rate from other neural populations, which is stochastic. The stochastic nature of this input would result in variations in the simulated observations which cannot be directly incorporated into the estimation procedure. An attempt is made to reduce their effect on the estimation procedure by increasing the uncertainty in the model. However, if the uncertainty in the model is increased excessively the estimation procedure fails (figure~\ref{fig: ESTFail}. This is due to the structure of the Kalman filter which attempts to balance the amount of information received from the estimated model states and the observations, based on the certainty of each. Consider figure~\ref{fig: ESTPass} where the observation noise is increased. This increase in noise leads to a decrease in the certainty in the measurements, which results in less variations in the estimate of the excitatory synaptic gain. This demonstrates that an increase in observation noise may benefit estimation up to a point.

\red{Estimation of model parameters}
In figure~\ref{fig: ESTMP3}  estimation of three model slow states is demonstrated. Here the excitatory gain still swings around its actual value. However, the estimate for the inhibitory synaptic gains converge to their true values. From this results, it is clear that the effect of the stochastic input on the model is filtered by the excitatory population, and the uncertainty in the estimation procedure can account for the small effect it has on the inhibitory slow states. This effect can be observed by noting that the stochastic input goes through an excitatory synapse before affecting the inhibitory populations. And when referring back to equation~\ref{eqn: LaplaceNMM} it is clear that these synapse act as low pass filters, that is they reduce the effect of high frequency noise. The estimation of the input mean shown in figure~\ref{fig: ESTMP4} converges to its actual value. This input mean specifies the mean of the stochastic input, and should not be affected by the variance of the actual input.

\red{Initialisation error}
Next the problem of initialisation error is considered. In figure~\ref{fig: EstInitFail} the model states are initialised randomly. The results show that if the parameter is distant from its actual value, the estimation procedure does not converge to the actual value of the slow states. This problem can be overcome by iteratively running the same estimation procedure but using different initial states drawn from a Gaussian distribution described in the methods section. Further, a criteria is assigned to the final estimate, that being that all final estimates should be within their specified physiological range. From figure~\ref{fig: EstInitPass} it is clear that although time consuming this procedure does eventually result in the convergence of the model slow states to their correct values. 

%Interestingly, the incorrect estimation converges to an incorrect value, and when observing the corresponding membrane potentials, excluding the pyramidal membrane potential, they were symmetric to the actual values around the x axis.

\red{Observation Noise}
If the noise in the observations is large the estimation procedure will fail. This effect is shown in figures~\ref{fig: ESTFail}-\ref{fig: ESTPass}. In figure~\ref{fig: ESTFail} two of the model parameters seem to diverge, indicating that the model has been unable to track the changes occurring in the observations.

\red{Parameters varying}
Lastly, and most importantly, the estimation of varying parameters is considered. In figure~\ref{fig: ESTMP3VP} it is shown that model parameters can be tracked even when they are varying within a single simulation. In figure~\ref{fig: ESTMP4VP} it is shown that the input mean can also be estimated during this procedure. Interestingly, the results from this procedure seem to indicate, that in this specific model, the slow inhibition synaptic gain is closely linked to the input mean, whereas the other model parameters do not seem to be affected by it. This result is interesting in light of studies where the input mean of the model is not estimated, and observations of the synaptic gain of the slow inhibitory population are considered to be responsible for the change in dynamics~\citep{wendling2005interictal}. It is worthwhile considering that the change in slow inhibition may be over or under-estimated if the input mean varies.

The results here have shown that the UKF is capable of estimating the synaptic gains and input mean of the Wendling model under numerous conditions. The insights gained from this estimation procedure may allow for better seizure prediction and detection. However, for on-line prediction of seizures (if this becomes possible) a method to initialise model parameters quickly and relatively accurately will need to be considered. Simplifying the model by linearising it and then using a linear Kalman  filter may allow for the parameters to be initialised with some accuracy, and then the estimation can be switched to the UKF for better accuracy. Using these kinds of techniques will not only help in the prediction and detection of seizure, but possibly in the treatment of neurological disorders. The effect of treatment on slow states can be compared to the effect of, for example, seizure on these states. Treatments can then be tailored to individual patients to force slow states farther away from the state subspace where the disorders clinical manifestations are observed.
